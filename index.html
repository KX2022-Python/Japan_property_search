<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="日本の物件検索 - シンプルなデザインの日本不動産検索エンジン">
  <title>日本の物件検索</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  <!-- 在head中取消注释Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3PUO73p9_03jQEQC592HeJ72tDdNVsKc" defer></script>
  <style>
    /* 内联基本样式，以防main.css加载失败 */
    body {
      font-family: 'Noto Sans JP', sans-serif;
      color: #333;
      background-color: #f5f5f5;
      line-height: 1.6;
      margin: 0;
      padding: 0;
    }
    
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    header {
      background-color: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1a1a1a;
    }
    
    nav ul {
      display: flex;
      gap: 20px;
      list-style: none;
    }
    
    nav a {
      text-decoration: none;
      color: #333;
    }
    
    .view-toggle {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    
    .view-toggle button {
      background-color: white;
      border: 1px solid #e0e0e0;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
    }
    
    .view-toggle button:first-child {
      border-radius: 4px 0 0 4px;
    }
    
    .view-toggle button:last-child {
      border-radius: 0 4px 4px 0;
    }
    
    .view-toggle button.active {
      background-color: #1a1a1a;
      color: white;
    }
    
    .filters {
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .property-card {
      background-color: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .property-image {
      height: 200px;
      background-color: #eee;
      position: relative;
      cursor: pointer;
    }
    
    .property-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .property-content {
      padding: 15px;
    }
    
    .property-price {
      font-size: 1.2rem;
      font-weight: 700;
      color: #ff4d4d;
      margin-bottom: 5px;
    }
    
    .list-view {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    
    /* 语言切换样式 */
    .language-toggle {
      margin-left: 20px;
      padding: 4px 8px;
      background-color: #f5f5f5;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 0.8rem;
      cursor: pointer;
    }
    
    /* 地区选择下拉菜单样式 */
    .location-dropdown {
      position: relative;
    }
    
    .location-menu {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      background-color: white;
      border: 1px solid #e0e0e0;
      border-radius: 0 0 4px 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 10;
      max-height: 300px;
      overflow-y: auto;
      display: none;
    }
    
    .location-menu.active {
      display: block;
    }
    
    .prefecture-list, .line-list, .station-list {
      padding: 10px;
    }
    
    .prefecture-item, .line-item, .station-item {
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 4px;
    }
    
    .prefecture-item:hover, .line-item:hover, .station-item:hover {
      background-color: #f5f5f5;
    }
    
    .location-nav {
      display: flex;
      border-bottom: 1px solid #e0e0e0;
      padding: 8px;
      background-color: #f9f9f9;
    }
    
    .location-nav span {
      font-size: 0.8rem;
      padding: 4px 8px;
      cursor: pointer;
    }
    
    .location-nav span.active {
      font-weight: bold;
      color: #ff4d4d;
    }
    
    .location-nav span:not(:last-child)::after {
      content: ">";
      margin: 0 4px;
      color: #bbb;
    }

    .new-badge, .viewed-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: #ff4d4d;
      color: white;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      animation: fadeInOut 0.5s ease-in-out;
    }

    .viewed-badge {
      background-color: #666;
    }

    .favorite-btn {
      position: absolute;
      top: 10px;
      right: 50px;
      z-index: 2;
      color: white;
      font-size: 24px;
      cursor: pointer;
      text-shadow: 0 0 3px rgba(0,0,0,0.5);
      transition: transform 0.2s ease;
    }

    .favorite-btn:hover {
      transform: scale(1.1);
    }

    .favorite-btn.active {
      color: #ffd700;
    }

    /* 添加收藏动画 */
    @keyframes favorite {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }

    .favorite-animation {
      animation: favorite 0.3s ease;
    }

    .location-group-title {
      font-weight: bold;
      padding: 8px 12px;
      background-color: #f5f5f5;
      margin-top: 10px;
    }

    .location-checkbox {
      margin-right: 8px;
    }

    .selected-item {
      background-color: #e0e0e0;
      padding: 2px 8px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .selected-item .remove-item {
      cursor: pointer;
      color: #666;
      font-size: 12px;
    }

    .selected-item .remove-item:hover {
      color: #ff4d4d;
    }

    .line-group, .station-group {
      margin-bottom: 15px;
    }

    .line-group-title, .station-group-title {
      font-weight: bold;
      padding: 8px 12px;
      background-color: #f5f5f5;
    }

    .multi-select {
      position: relative;
      cursor: pointer;
    }

    .multi-select .selected-items {
      min-height: 22px;
    }

    .multi-select .options-menu {
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .multi-select .option {
      padding: 8px 12px;
      cursor: pointer;
    }

    .multi-select .option:hover {
      background-color: #f5f5f5;
    }

    .multi-select .selected-tag {
      background-color: #e0e0e0;
      padding: 2px 8px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
      margin: 2px;
    }

    .multi-select .remove-tag {
      cursor: pointer;
      color: #666;
      font-size: 12px;
    }

    .multi-select .remove-tag:hover {
      color: #ff4d4d;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container container">
      <div class="logo" data-ja="日本の物件検索" data-zh="日本房源搜索">日本の物件検索</div>
      <nav>
        <ul>
          <li><a href="#" data-ja="ホーム" data-zh="首页">ホーム</a></li>
          <li><a href="#" data-ja="お気に入り" data-zh="收藏">お気に入り</a></li>
          <li><a href="#" data-ja="について" data-zh="关于">について</a></li>
          <li><button class="language-toggle" data-current="ja">中文</button></li>
        </ul>
      </nav>
    </div>
  </header>
  
  <!-- 在body标签内，main标签前添加提示消息容器 -->
  <div id="updateMessage" style="display: none; position: fixed; top: 20px; right: 20px; background-color: rgba(0, 0, 0, 0.8); color: white; padding: 10px 20px; border-radius: 4px; z-index: 1000;" data-ja="現在のデータは最新です" data-zh="目前已是最新数据">
    現在のデータは最新です
  </div>
  
  <main class="container">
    <div class="view-toggle">
      <button class="active" data-ja="リスト表示" data-zh="列表视图">リスト表示</button>
      <button data-ja="地図表示" data-zh="地图视图">地図表示</button>
    </div>
    
    <div class="filters">
      <h3 data-ja="検索条件" data-zh="筛选条件">検索条件</h3>
      <form>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
          <div class="location-dropdown">
            <label for="location" style="display: block; margin-bottom: 5px;" data-ja="エリア（複数選択可）" data-zh="地区（可多选）">エリア（複数選択可）</label>
            <div id="location" style="width: 100%; min-height: 38px; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; cursor: pointer; background-color: white;" data-ja-placeholder="都県、路線または駅を選択" data-zh-placeholder="选择都县、线路或车站">
              <div class="selected-items" style="display: flex; flex-wrap: wrap; gap: 5px;"></div>
            </div>
            
            <div class="location-menu" id="locationMenu">
              <div class="location-nav">
                <span class="location-nav-prefecture active" data-ja="都県" data-zh="都县">都県</span>
                <span class="location-nav-line" data-ja="路線" data-zh="线路">路線</span>
                <span class="location-nav-station" data-ja="駅" data-zh="车站">駅</span>
              </div>
              
              <div class="prefecture-list">
                <div class="prefecture-item" data-value="東京都">
                  <input type="checkbox" id="tokyo" class="location-checkbox">
                  <label for="tokyo">東京都</label>
                </div>
                <div class="prefecture-item" data-value="神奈川県">
                  <input type="checkbox" id="kanagawa" class="location-checkbox">
                  <label for="kanagawa">神奈川県</label>
                </div>
                <div class="prefecture-item" data-value="埼玉県">
                  <input type="checkbox" id="saitama" class="location-checkbox">
                  <label for="saitama">埼玉県</label>
                </div>
                <div class="prefecture-item" data-value="千葉県">
                  <input type="checkbox" id="chiba" class="location-checkbox">
                  <label for="chiba">千葉県</label>
                </div>
              </div>
              
              <div class="line-list" style="display: none;">
                <div class="line-group">
                  <div class="line-group-title">JR線</div>
                  <div class="line-item" data-value="山手線">
                    <input type="checkbox" id="yamanote" class="location-checkbox">
                    <label for="yamanote">山手線</label>
                  </div>
                  <div class="line-item" data-value="中央線">
                    <input type="checkbox" id="chuo" class="location-checkbox">
                    <label for="chuo">中央線</label>
                  </div>
                  <div class="line-item" data-value="総武線">
                    <input type="checkbox" id="sobu" class="location-checkbox">
                    <label for="sobu">総武線</label>
                  </div>
                  <div class="line-item" data-value="埼京線">
                    <input type="checkbox" id="saikyo" class="location-checkbox">
                    <label for="saikyo">埼京線</label>
                  </div>
                </div>
                
                <div class="line-group">
                  <div class="line-group-title">東京メトロ</div>
                  <div class="line-item" data-value="銀座線">
                    <input type="checkbox" id="ginza" class="location-checkbox">
                    <label for="ginza">銀座線</label>
                  </div>
                  <div class="line-item" data-value="丸ノ内線">
                    <input type="checkbox" id="marunouchi" class="location-checkbox">
                    <label for="marunouchi">丸ノ内線</label>
                  </div>
                  <div class="line-item" data-value="日比谷線">
                    <input type="checkbox" id="hibiya" class="location-checkbox">
                    <label for="hibiya">日比谷線</label>
                  </div>
                </div>
              </div>
              
              <div class="station-list" style="display: none;">
                <div class="station-group yamanote-stations">
                  <div class="station-group-title">山手線</div>
                  <div class="station-item" data-value="新宿">
                    <input type="checkbox" id="shinjuku" class="location-checkbox">
                    <label for="shinjuku">新宿駅</label>
                  </div>
                  <div class="station-item" data-value="渋谷">
                    <input type="checkbox" id="shibuya" class="location-checkbox">
                    <label for="shibuya">渋谷駅</label>
                  </div>
                  <div class="station-item" data-value="池袋">
                    <input type="checkbox" id="ikebukuro" class="location-checkbox">
                    <label for="ikebukuro">池袋駅</label>
                  </div>
                </div>
                
                <div class="station-group chuo-stations">
                  <div class="station-group-title">中央線</div>
                  <div class="station-item" data-value="中野">
                    <input type="checkbox" id="nakano" class="location-checkbox">
                    <label for="nakano">中野駅</label>
                  </div>
                  <div class="station-item" data-value="高円寺">
                    <input type="checkbox" id="koenji" class="location-checkbox">
                    <label for="koenji">高円寺駅</label>
                  </div>
                  <div class="station-item" data-value="阿佐ヶ谷">
                    <input type="checkbox" id="asagaya" class="location-checkbox">
                    <label for="asagaya">阿佐ヶ谷駅</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div>
            <label for="priceMin" style="display: block; margin-bottom: 5px;" data-ja="最低価格 (万円)" data-zh="最低价格 (万日币)">最低価格 (万円)</label>
            <select id="priceMin" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px;">
              <option value="" data-ja="指定なし" data-zh="不限">指定なし</option>
              <option value="1000">1,000</option>
              <option value="2000">2,000</option>
              <option value="3000">3,000</option>
              <option value="4000">4,000</option>
              <option value="5000">5,000</option>
              <option value="6000">6,000</option>
              <option value="7000">7,000</option>
              <option value="8000">8,000</option>
              <option value="9000">9,000</option>
              <option value="10000">10,000</option>
              <option value="12000">12,000</option>
              <option value="15000">15,000</option>
              <option value="20000">20,000</option>
              <option value="25000">25,000</option>
              <option value="30000">30,000</option>
            </select>
          </div>
          
          <div>
            <label for="priceMax" style="display: block; margin-bottom: 5px;" data-ja="最高価格 (万円)" data-zh="最高价格 (万日币)">最高価格 (万円)</label>
            <select id="priceMax" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px;">
              <option value="" data-ja="指定なし" data-zh="不限">指定なし</option>
              <option value="1000">1,000</option>
              <option value="2000">2,000</option>
              <option value="3000">3,000</option>
              <option value="4000">4,000</option>
              <option value="5000">5,000</option>
              <option value="6000">6,000</option>
              <option value="7000">7,000</option>
              <option value="8000">8,000</option>
              <option value="9000">9,000</option>
              <option value="10000">10,000</option>
              <option value="12000">12,000</option>
              <option value="15000">15,000</option>
              <option value="20000">20,000</option>
              <option value="25000">25,000</option>
              <option value="30000">30,000</option>
            </select>
          </div>
          
          <div>
            <label for="areaMin" style="display: block; margin-bottom: 5px;" data-ja="最小面積 (㎡)" data-zh="最小面积 (㎡)">最小面積 (㎡)</label>
            <select id="areaMin" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px;">
              <option value="" data-ja="指定なし" data-zh="不限">指定なし</option>
              <option value="40">40</option>
              <option value="50">50</option>
              <option value="60">60</option>
              <option value="70">70</option>
              <option value="80">80</option>
              <option value="90">90</option>
              <option value="100">100</option>
              <option value="120">120</option>
              <option value="140">140</option>
              <option value="160">160</option>
              <option value="180">180</option>
              <option value="200">200</option>
            </select>
          </div>
          
          <div>
            <label for="areaMax" style="display: block; margin-bottom: 5px;" data-ja="最大面積 (㎡)" data-zh="最大面积 (㎡)">最大面積 (㎡)</label>
            <select id="areaMax" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px;">
              <option value="" data-ja="指定なし" data-zh="不限">指定なし</option>
              <option value="40">40</option>
              <option value="50">50</option>
              <option value="60">60</option>
              <option value="70">70</option>
              <option value="80">80</option>
              <option value="90">90</option>
              <option value="100">100</option>
              <option value="120">120</option>
              <option value="140">140</option>
              <option value="160">160</option>
              <option value="180">180</option>
              <option value="200">200</option>
            </select>
          </div>
          
          <div>
            <label for="rooms" style="display: block; margin-bottom: 5px;" data-ja="間取り（複数選択可）" data-zh="房型（可多选）">間取り（複数選択可）</label>
            <div class="multi-select" id="rooms-select" style="width: 100%; min-height: 38px; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; background-color: white;">
              <div class="selected-items" style="display: flex; flex-wrap: wrap; gap: 5px;"></div>
              <div class="options-menu" style="display: none; position: absolute; width: 100%; background: white; border: 1px solid #e0e0e0; border-radius: 4px; margin-top: 5px; max-height: 200px; overflow-y: auto; z-index: 1000;">
                <div class="option">
                  <input type="checkbox" id="room-1" value="1">
                  <label for="room-1" data-ja="1R/1K" data-zh="1R/1K">1R/1K</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="room-1.5" value="1.5">
                  <label for="room-1.5" data-ja="1DK/1LDK" data-zh="1DK/1LDK">1DK/1LDK</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="room-2" value="2">
                  <label for="room-2" data-ja="2K/2DK" data-zh="2K/2DK">2K/2DK</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="room-2.5" value="2.5">
                  <label for="room-2.5" data-ja="2LDK" data-zh="2LDK">2LDK</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="room-3" value="3">
                  <label for="room-3" data-ja="3K/3DK/3LDK" data-zh="3K/3DK/3LDK">3K/3DK/3LDK</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="room-4" value="4">
                  <label for="room-4" data-ja="4K以上" data-zh="4K以上">4K以上</label>
                </div>
              </div>
            </div>
          </div>
          
          <div>
            <label for="orientation" style="display: block; margin-bottom: 5px;" data-ja="リビング向き（複数選択可）" data-zh="朝向（可多选）">リビング向き（複数選択可）</label>
            <div class="multi-select" id="orientation-select" style="width: 100%; min-height: 38px; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; background-color: white;">
              <div class="selected-items" style="display: flex; flex-wrap: wrap; gap: 5px;"></div>
              <div class="options-menu" style="display: none; position: absolute; width: 100%; background: white; border: 1px solid #e0e0e0; border-radius: 4px; margin-top: 5px; max-height: 200px; overflow-y: auto; z-index: 1000;">
                <div class="option">
                  <input type="checkbox" id="north" value="north">
                  <label for="north" data-ja="北向き" data-zh="朝北">北向き</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="south" value="south">
                  <label for="south" data-ja="南向き" data-zh="朝南">南向き</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="east" value="east">
                  <label for="east" data-ja="東向き" data-zh="朝东">東向き</label>
                </div>
                <div class="option">
                  <input type="checkbox" id="west" value="west">
                  <label for="west" data-ja="西向き" data-zh="朝西">西向き</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div style="display: flex; justify-content: flex-end; margin-top: 15px;">
          <button type="button" id="updateButton" style="background-color: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;" data-ja="データを更新" data-zh="更新数据">
            データを更新
          </button>
          <button type="button" style="background-color: transparent; border: 1px solid #e0e0e0; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;" data-ja="条件をリセット" data-zh="重置筛选">
            条件をリセット
          </button>
          <button type="submit" style="background-color: #ff4d4d; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;" data-ja="検索する" data-zh="应用筛选">
            検索する
          </button>
        </div>
      </form>
    </div>
    
    <div class="list-view">
      <div class="property-card">
        <div class="property-image">
          <div class="status-badge"></div>
          <div class="favorite-btn" data-ja="お気に入り追加" data-zh="添加收藏">★</div>
          <img src="https://picsum.photos/id/101/600/400" alt="物件画像">
          <div style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" data-ja="3つの情報源" data-zh="3个来源">
            3つの情報源
          </div>
        </div>
        <div class="property-content">
          <div class="property-price">125.5万円</div>
          <div style="font-size: 0.9rem; color: #bbbbbb; margin-bottom: 10px;">東京都新宿区1-2-3</div>
          <div style="display: flex; gap: 15px; margin-bottom: 10px;">
            <div style="font-size: 0.9rem;">35㎡</div>
            <div style="font-size: 0.9rem;">1LDK</div>
            <div style="font-size: 0.9rem;" data-ja="築2018年" data-zh="建于2018年">築2018年</div>
          </div>
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; display: flex; flex-wrap: wrap; gap: 8px;">
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              SUUMO
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              at home
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              HOMES
            </a>
          </div>
        </div>
      </div>
      
      <div class="property-card">
        <div class="property-image">
          <div class="status-badge"></div>
          <div class="favorite-btn" data-ja="お気に入り追加" data-zh="添加收藏">★</div>
          <img src="https://picsum.photos/id/102/600/400" alt="物件画像">
          <div style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" data-ja="2つの情報源" data-zh="2个来源">
            2つの情報源
          </div>
        </div>
        <div class="property-content">
          <div class="property-price">78.0万円</div>
          <div style="font-size: 0.9rem; color: #bbbbbb; margin-bottom: 10px;">東京都渋谷区4-5-6</div>
          <div style="display: flex; gap: 15px; margin-bottom: 10px;">
            <div style="font-size: 0.9rem;">25㎡</div>
            <div style="font-size: 0.9rem;">1K</div>
            <div style="font-size: 0.9rem;" data-ja="築2015年" data-zh="建于2015年">築2015年</div>
          </div>
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; display: flex; flex-wrap: wrap; gap: 8px;">
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              SUUMO
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              LIFULL HOME'S
            </a>
          </div>
        </div>
      </div>
      
      <div class="property-card">
        <div class="property-image">
          <div class="status-badge"></div>
          <div class="favorite-btn" data-ja="お気に入り追加" data-zh="添加收藏">★</div>
          <img src="https://picsum.photos/id/103/600/400" alt="物件画像">
          <div style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" data-ja="4つの情報源" data-zh="4个来源">
            4つの情報源
          </div>
        </div>
        <div class="property-content">
          <div class="property-price">156.8万円</div>
          <div style="font-size: 0.9rem; color: #bbbbbb; margin-bottom: 10px;">東京都港区7-8-9</div>
          <div style="display: flex; gap: 15px; margin-bottom: 10px;">
            <div style="font-size: 0.9rem;">48㎡</div>
            <div style="font-size: 0.9rem;">2LDK</div>
            <div style="font-size: 0.9rem;" data-ja="築2020年" data-zh="建于2020年">築2020年</div>
          </div>
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; display: flex; flex-wrap: wrap; gap: 8px;">
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              HOMES
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              at home
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              カウカモ
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              Yahoo!不動産
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- 在main标签内,list-view后添加地图容器 -->
    <div id="map-view" style="display: none; height: 800px; margin-bottom: 20px; border-radius: 8px; overflow: hidden;">
      <div id="map" style="width: 100%; height: 100%;"></div>
    </div>
  </main>
  
  <footer style="background-color: #1a1a1a; color: white; padding: 20px 0; margin-top: 40px;">
    <div class="container" style="text-align: center;">
      <p data-ja="© 2023 日本の物件検索 - シンプルなデザインの日本不動産検索エンジン" data-zh="© 2023 日本房源搜索 - 极简风格的日本房产搜索引擎">© 2023 日本の物件検索 - シンプルなデザインの日本不動産検索エンジン</p>
    </div>
  </footer>
  
  <!-- 修改JavaScript部分,在script标签内添加地图相关功能 -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 语言切换功能
      const languageToggle = document.querySelector('.language-toggle');
      let currentLang = 'ja'; // 默认语言为日语
      
      languageToggle.addEventListener('click', function() {
        // 切换语言
        currentLang = currentLang === 'ja' ? 'zh' : 'ja';
        this.setAttribute('data-current', currentLang);
        
        // 更新按钮文本
        this.textContent = currentLang === 'ja' ? '中文' : '日本語';
        
        // 更新所有带有data-ja和data-zh属性的元素
        const elements = document.querySelectorAll('[data-ja][data-zh]');
        elements.forEach(el => {
          el.textContent = el.getAttribute(`data-${currentLang}`);
        });
        
        // 更新所有输入框的placeholder
        const inputs = document.querySelectorAll('input[data-ja-placeholder][data-zh-placeholder]');
        inputs.forEach(input => {
          input.placeholder = input.getAttribute(`data-${currentLang}-placeholder`);
        });
        
        // 更新所有选项的文本
        const options = document.querySelectorAll('option[data-ja][data-zh]');
        options.forEach(option => {
          option.textContent = option.getAttribute(`data-${currentLang}`);
        });

        // 更新提示消息的文本
        const updateMessage = document.getElementById('updateMessage');
        if (updateMessage.style.display === 'block') {
          updateMessage.textContent = currentLang === 'ja' ? '現在のデータは最新です' : '目前已是最新数据';
        }

        // 更新已看标签的文本
        document.querySelectorAll('.viewed-badge').forEach(badge => {
          badge.textContent = currentLang === 'ja' ? '閲覧済' : '已看';
        });
      });
      
      // 地区选择功能
      const locationInput = document.getElementById('location');
      const locationMenu = document.getElementById('locationMenu');
      
      // 点击输入框时显示地区选择菜单
      locationInput.addEventListener('click', function(e) {
        e.stopPropagation();
        locationMenu.classList.toggle('active');
      });
      
      // 点击页面其他部分关闭地区选择菜单
      document.addEventListener('click', function(e) {
        if (!locationMenu.contains(e.target) && e.target !== locationInput) {
          locationMenu.classList.remove('active');
        }
      });
      
      // 导航菜单切换
      const prefectureNav = document.querySelector('.location-nav-prefecture');
      const lineNav = document.querySelector('.location-nav-line');
      const stationNav = document.querySelector('.location-nav-station');
      
      const prefectureList = document.querySelector('.prefecture-list');
      const lineList = document.querySelector('.line-list');
      const stationList = document.querySelector('.station-list');
      
      prefectureNav.addEventListener('click', function() {
        prefectureNav.classList.add('active');
        lineNav.classList.remove('active');
        stationNav.classList.remove('active');
        
        prefectureList.style.display = 'block';
        lineList.style.display = 'none';
        stationList.style.display = 'none';
      });
      
      lineNav.addEventListener('click', function() {
        prefectureNav.classList.remove('active');
        lineNav.classList.add('active');
        stationNav.classList.remove('active');
        
        prefectureList.style.display = 'none';
        lineList.style.display = 'block';
        stationList.style.display = 'none';
      });
      
      stationNav.addEventListener('click', function() {
        prefectureNav.classList.remove('active');
        lineNav.classList.remove('active');
        stationNav.classList.add('active');
        
        prefectureList.style.display = 'none';
        lineList.style.display = 'none';
        stationList.style.display = 'block';
      });
      
      // 添加多选功能
      const selectedLocations = new Set();

      function updateSelectedItems() {
        const selectedItemsContainer = document.querySelector('.selected-items');
        selectedItemsContainer.innerHTML = '';
        
        selectedLocations.forEach(location => {
          const item = document.createElement('div');
          item.className = 'selected-item';
          item.innerHTML = `
            ${location}
            <span class="remove-item" data-value="${location}">×</span>
          `;
          selectedItemsContainer.appendChild(item);
        });
        
        // 更新输入框显示
        const locationInput = document.getElementById('location');
        if (selectedLocations.size === 0) {
          locationInput.setAttribute('data-placeholder', currentLang === 'ja' ? '都県、路線または駅を選択' : '选择都县、线路或车站');
        }
      }

      // 处理选择框点击事件
      document.querySelectorAll('.location-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const value = this.closest('[data-value]').getAttribute('data-value');
          if (this.checked) {
            selectedLocations.add(value);
          } else {
            selectedLocations.delete(value);
          }
          updateSelectedItems();
        });
      });

      // 处理删除选中项
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-item')) {
          const value = e.target.getAttribute('data-value');
          selectedLocations.delete(value);
          // 更新对应的复选框状态
          document.querySelectorAll('.location-checkbox').forEach(checkbox => {
            if (checkbox.closest('[data-value]').getAttribute('data-value') === value) {
              checkbox.checked = false;
            }
          });
          updateSelectedItems();
        }
      });
      
      // 修改显示线路的函数
      function showLinesForPrefecture(prefecture) {
        const allLines = document.querySelectorAll('.line-item');
        allLines.forEach(line => line.style.display = 'none');
        
        // 根据选择的都县显示相应的线路
        switch(prefecture) {
          case '東京都':
            document.querySelectorAll('.line-item').forEach(line => line.style.display = 'block');
            break;
          case '神奈川県':
            // 显示神奈川县的线路
            document.querySelectorAll('.line-item[data-area="kanagawa"]').forEach(line => line.style.display = 'block');
            break;
          case '埼玉県':
            // 显示埼玉县的线路
            document.querySelectorAll('.line-item[data-area="saitama"]').forEach(line => line.style.display = 'block');
            break;
          case '千葉県':
            // 显示千叶县的线路
            document.querySelectorAll('.line-item[data-area="chiba"]').forEach(line => line.style.display = 'block');
            break;
        }
      }
      
      // 视图切换功能
      const viewButtons = document.querySelectorAll('.view-toggle button');
      const listView = document.querySelector('.list-view');
      const mapView = document.getElementById('map-view');
      
      viewButtons.forEach(button => {
        button.addEventListener('click', function() {
          viewButtons.forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          
          if(this.textContent.includes('地図') || this.textContent.includes('地图')) {
            listView.style.display = 'none';
            mapView.style.display = 'block';
            // 初始化地图
            if (!map) {
              initMap();
            }
            // 触发resize事件以确保地图正确显示
            google.maps.event.trigger(map, 'resize');
          } else {
            listView.style.display = 'grid';
            mapView.style.display = 'none';
          }
        });
      });
      
      // 筛选器重置功能
      const resetButton = document.querySelector('button[type="button"]');
      if(resetButton) {
        resetButton.addEventListener('click', function() {
          document.querySelectorAll('input, select').forEach(input => {
            input.value = '';
          });
        });
      }
      
      // 筛选器提交功能
      const filterForm = document.querySelector('.filters form');
      if(filterForm) {
        filterForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // 获取多选值
          const getSelectedValues = (selectId) => {
            const checkboxes = document.querySelectorAll(`#${selectId} input[type="checkbox"]:checked`);
            return Array.from(checkboxes).map(cb => cb.value);
          };
          
          const selectedRooms = getSelectedValues('rooms-select');
          const selectedOrientations = getSelectedValues('orientation-select');
          
          // 其他筛选条件...
          const location = document.getElementById('location').value;
          const priceMin = document.getElementById('priceMin').value;
          const priceMax = document.getElementById('priceMax').value;
          const areaMin = document.getElementById('areaMin').value;
          const areaMax = document.getElementById('areaMax').value;
          
          // 显示筛选条件
          const alertMessage = currentLang === 'ja' 
            ? `検索条件:\n地区: ${Array.from(selectedLocations).join(', ') || '指定なし'}\n価格: ${priceMin || '0'} - ${priceMax || '不限'}\n面積: ${areaMin || '0'} - ${areaMax || '不限'}\n間取り: ${selectedRooms.join(', ') || '指定なし'}\n向き: ${selectedOrientations.join(', ') || '指定なし'}`
            : `筛选条件:\n地区: ${Array.from(selectedLocations).join(', ') || '不限'}\n价格: ${priceMin || '0'} - ${priceMax || '不限'}\n面积: ${areaMin || '0'} - ${areaMax || '不限'}\n房型: ${selectedRooms.join(', ') || '不限'}\n朝向: ${selectedOrientations.join(', ') || '不限'}`;
          
          alert(alertMessage);
        });
      }

      // 修改更新按钮功能
      const updateButton = document.getElementById('updateButton');
      if(updateButton) {
        updateButton.addEventListener('click', async function() {
          try {
            // 显示加载状态
            updateButton.disabled = true;
            const originalText = updateButton.textContent;
            updateButton.textContent = currentLang === 'ja' ? '更新中...' : '更新中...';
            
            // 获取当前筛选条件
            const filters = {
              location: document.getElementById('location').value,
              priceMin: document.getElementById('priceMin').value,
              priceMax: document.getElementById('priceMax').value,
              areaMin: document.getElementById('areaMin').value,
              areaMax: document.getElementById('areaMax').value,
              rooms: document.getElementById('rooms-select').value,
              orientation: document.getElementById('orientation-select').value
            };
            
            // 模拟数据更新过程
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // 模拟检查是否有新数据（这里随机模拟）
            const hasNewData = Math.random() > 0.5;
            
            if (hasNewData) {
              // 模拟新数据，为部分房源添加NEW标签
              const propertyCards = document.querySelectorAll('.property-card');
              propertyCards.forEach(card => {
                // 随机为30%的房源添加NEW标签
                if (Math.random() < 0.3) {
                  // 移除已有的NEW标签（如果存在）
                  const existingBadge = card.querySelector('.new-badge');
                  if (existingBadge) {
                    existingBadge.remove();
                  }
                  
                  // 添加新的NEW标签
                  const newBadge = document.createElement('div');
                  newBadge.className = 'new-badge';
                  newBadge.textContent = 'NEW';
                  card.querySelector('.property-image').appendChild(newBadge);
                }
              });
              
              // 显示更新成功提示
              const message = currentLang === 'ja' 
                ? '最新のデータに更新されました。\n\n更新された情報源:\n- SUUMO\n- at home\n- HOMES\n- Yahoo!不動産'
                : '数据已更新完成。\n\n已更新来源:\n- SUUMO\n- at home\n- HOMES\n- Yahoo!房产';
              
              alert(message);
            } else {
              // 显示无更新提示
              const updateMessage = document.getElementById('updateMessage');
              updateMessage.style.display = 'block';
              updateMessage.textContent = currentLang === 'ja' ? '現在のデータは最新です' : '目前已是最新数据';
              
              // 1.5秒后自动隐藏提示
              setTimeout(() => {
                updateMessage.style.display = 'none';
              }, 1500);
            }
            
            // 恢复按钮状态
            updateButton.disabled = false;
            updateButton.textContent = originalText;
            
          } catch (error) {
            // 发生错误时显示错误信息
            const errorMessage = currentLang === 'ja'
              ? 'データの更新中にエラーが発生しました。もう一度お試しください。'
              : '数据更新过程中发生错误，请重试。';
            
            alert(errorMessage);
            
            // 恢复按钮状态
            updateButton.disabled = false;
            updateButton.textContent = originalText;
          }
        });
      }

      // 添加地图相关功能
      let map;
      let markers = [];
      const properties = [
        {
          position: { lat: 35.6894, lng: 139.6917 }, // 新宿
          price: '125.5万円',
          address: '東京都新宿区1-2-3',
          area: '35㎡',
          layout: '1LDK',
          built: '2018',
          image: 'https://picsum.photos/id/101/600/400'
        },
        {
          position: { lat: 35.6580, lng: 139.7016 }, // 渋谷
          price: '78.0万円',
          address: '東京都渋谷区4-5-6',
          area: '25㎡',
          layout: '1K',
          built: '2015',
          image: 'https://picsum.photos/id/102/600/400'
        },
        {
          position: { lat: 35.6585, lng: 139.7454 }, // 港区
          price: '156.8万円',
          address: '東京都港区7-8-9',
          area: '48㎡',
          layout: '2LDK',
          built: '2020',
          image: 'https://picsum.photos/id/103/600/400'
        }
      ];

      // 初始化地图
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: { lat: 35.6894, lng: 139.6917 }, // 默认中心点设在新宿
          zoom: 13,
          styles: [
            {
              featureType: 'poi',
              elementType: 'labels',
              stylers: [{ visibility: 'off' }]
            }
          ]
        });

        // 创建信息窗口
        const infoWindow = new google.maps.InfoWindow();

        // 为每个房源添加标记
        properties.forEach(property => {
          const marker = new google.maps.Marker({
            position: property.position,
            map: map,
            animation: google.maps.Animation.DROP
          });

          // 创建信息窗口内容
          const content = `
            <div style="width: 250px;">
              <img src="${property.image}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 4px;">
              <div style="padding: 10px;">
                <div style="font-size: 1.2rem; font-weight: bold; color: #ff4d4d;">${property.price}</div>
                <div style="font-size: 0.9rem; color: #666; margin: 5px 0;">${property.address}</div>
                <div style="display: flex; gap: 10px; font-size: 0.9rem; color: #333;">
                  <span>${property.area}</span>
                  <span>${property.layout}</span>
                  <span>築${property.built}年</span>
                </div>
              </div>
            </div>
          `;

          // 添加点击事件
          marker.addListener('click', () => {
            infoWindow.setContent(content);
            infoWindow.open(map, marker);
          });

          markers.push(marker);
        });
      }

      // 初始化多选功能
      function initMultiSelect(selectId, options) {
        const container = document.getElementById(selectId);
        const selectedItems = container.querySelector('.selected-items');
        const optionsMenu = container.querySelector('.options-menu');
        const checkboxes = optionsMenu.querySelectorAll('input[type="checkbox"]');
        
        // 点击容器显示/隐藏选项菜单
        container.addEventListener('click', (e) => {
          e.stopPropagation();
          optionsMenu.style.display = optionsMenu.style.display === 'none' ? 'block' : 'none';
        });
        
        // 点击其他地方关闭菜单
        document.addEventListener('click', () => {
          optionsMenu.style.display = 'none';
        });
        
        // 处理选项选择
        checkboxes.forEach(checkbox => {
          checkbox.addEventListener('change', () => {
            updateSelectedItems();
          });
        });
        
        // 更新已选项显示
        function updateSelectedItems() {
          selectedItems.innerHTML = '';
          checkboxes.forEach(checkbox => {
            if (checkbox.checked) {
              const label = checkbox.nextElementSibling.textContent;
              const tag = document.createElement('div');
              tag.className = 'selected-tag';
              tag.innerHTML = `
                ${label}
                <span class="remove-tag" data-value="${checkbox.value}">×</span>
              `;
              selectedItems.appendChild(tag);
            }
          });
        }
        
        // 处理删除标签
        selectedItems.addEventListener('click', (e) => {
          if (e.target.classList.contains('remove-tag')) {
            const value = e.target.dataset.value;
            const checkbox = optionsMenu.querySelector(`input[value="${value}"]`);
            checkbox.checked = false;
            updateSelectedItems();
          }
        });
      }

      // 在文档加载完成后初始化多选功能
      document.addEventListener('DOMContentLoaded', () => {
        initMultiSelect('rooms-select');
        initMultiSelect('orientation-select');
      });

      // 添加查看和收藏功能
      let viewedProperties = JSON.parse(localStorage.getItem('viewedProperties')) || [];
      let favoriteProperties = JSON.parse(localStorage.getItem('favoriteProperties')) || [];
      
      // 初始化所有房源卡片
      document.querySelectorAll('.property-card').forEach((card, index) => {
        const propertyId = `property-${index}`; // 为每个房源创建唯一ID
        card.setAttribute('data-property-id', propertyId);
        
        // 创建状态标签容器
        const statusBadge = card.querySelector('.status-badge');
        
        // 创建收藏按钮
        const favoriteBtn = card.querySelector('.favorite-btn');
        
        // 初始化状态
        if (viewedProperties.includes(propertyId)) {
          updateViewedStatus(statusBadge, true);
        }
        if (favoriteProperties.includes(propertyId)) {
          favoriteBtn.classList.add('active');
        }
        
        // 添加点击查看事件
        card.addEventListener('click', function(e) {
          // 如果点击的是收藏按钮，不触发查看事件
          if (e.target.classList.contains('favorite-btn')) {
            return;
          }
          
          if (!viewedProperties.includes(propertyId)) {
            viewedProperties.push(propertyId);
            localStorage.setItem('viewedProperties', JSON.stringify(viewedProperties));
            updateViewedStatus(statusBadge, true);
          }
        });
        
        // 添加收藏事件
        favoriteBtn.addEventListener('click', function(e) {
          e.stopPropagation(); // 阻止冒泡，避免触发卡片的点击事件
          
          this.classList.toggle('active');
          this.classList.add('favorite-animation');
          
          // 移除动画类
          setTimeout(() => {
            this.classList.remove('favorite-animation');
          }, 300);
          
          if (this.classList.contains('active')) {
            if (!favoriteProperties.includes(propertyId)) {
              favoriteProperties.push(propertyId);
              showToast(currentLang === 'ja' ? 'お気に入りに追加しました' : '已添加到收藏');
            }
          } else {
            favoriteProperties = favoriteProperties.filter(id => id !== propertyId);
            showToast(currentLang === 'ja' ? 'お気に入りから削除しました' : '已从收藏中移除');
          }
          
          localStorage.setItem('favoriteProperties', JSON.stringify(favoriteProperties));
        });
      });
      
      // 更新查看状态的函数
      function updateViewedStatus(statusBadge, isViewed) {
        const existingBadge = statusBadge.querySelector('.new-badge, .viewed-badge');
        if (existingBadge) {
          existingBadge.remove();
        }
        
        if (isViewed) {
          const viewedBadge = document.createElement('div');
          viewedBadge.className = 'viewed-badge';
          viewedBadge.textContent = currentLang === 'ja' ? '閲覧済' : '已看';
          statusBadge.appendChild(viewedBadge);
        }
      }
      
      // 显示提示消息的函数
      function showToast(message) {
        const toast = document.createElement('div');
        toast.style.cssText = `
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          background-color: rgba(0, 0, 0, 0.8);
          color: white;
          padding: 10px 20px;
          border-radius: 4px;
          z-index: 1000;
        `;
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
          toast.remove();
        }, 2000);
      }
    });
  </script>
</body>
</html> 