<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="æ—¥æœ¬ã®ç‰©ä»¶æ¤œç´¢ - ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã®æ—¥æœ¬ä¸å‹•ç”£æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³">
  <title>æ—¥æœ¬ã®ç‰©ä»¶æ¤œç´¢</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  <!-- åœ¨headä¸­å–æ¶ˆæ³¨é‡ŠGoogle Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3PUO73p9_03jQEQC592HeJ72tDdNVsKc" defer></script>
  <style>
    /* å†…è”åŸºæœ¬æ ·å¼ï¼Œä»¥é˜²main.cssåŠ è½½å¤±è´¥ */
    body {
      font-family: 'Noto Sans JP', sans-serif;
      color: #333;
      background-color: #f5f5f5;
      line-height: 1.6;
      margin: 0;
      padding: 0;
    }
    
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    header {
      background-color: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1a1a1a;
    }
    
    nav ul {
      display: flex;
      gap: 20px;
      list-style: none;
    }
    
    nav a {
      text-decoration: none;
      color: #333;
    }
    
    .view-toggle {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    
    .view-toggle button {
      background-color: white;
      border: 1px solid #e0e0e0;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
    }
    
    .view-toggle button:first-child {
      border-radius: 4px 0 0 4px;
    }
    
    .view-toggle button:last-child {
      border-radius: 0 4px 4px 0;
    }
    
    .view-toggle button.active {
      background-color: #1a1a1a;
      color: white;
    }
    
    .filters {
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .property-card {
      background-color: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .property-image {
      height: 200px;
      background-color: #eee;
      position: relative;
      cursor: pointer;
    }
    
    .property-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .property-content {
      padding: 15px;
    }
    
    .property-price {
      font-size: 1.2rem;
      font-weight: 700;
      color: #ff4d4d;
      margin-bottom: 5px;
    }
    
    .list-view {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    
    /* è¯­è¨€åˆ‡æ¢æ ·å¼ */
    .language-toggle {
      margin-left: 20px;
      padding: 4px 8px;
      background-color: #f5f5f5;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 0.8rem;
      cursor: pointer;
    }
    
    /* åœ°åŒºé€‰æ‹©ä¸‹æ‹‰èœå•æ ·å¼ */
    .location-dropdown {
      position: relative;
    }
    
    .location-menu {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      background-color: white;
      border: 1px solid #e0e0e0;
      border-radius: 0 0 4px 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 10;
      max-height: 300px;
      overflow-y: auto;
      display: none;
    }
    
    .location-menu.active {
      display: block;
    }
    
    .prefecture-list, .line-list, .station-list {
      padding: 10px;
    }
    
    .prefecture-item, .line-item, .station-item {
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 4px;
    }
    
    .prefecture-item:hover, .line-item:hover, .station-item:hover {
      background-color: #f5f5f5;
    }
    
    .location-nav {
      display: flex;
      border-bottom: 1px solid #e0e0e0;
      padding: 8px;
      background-color: #f9f9f9;
    }
    
    .location-nav span {
      font-size: 0.8rem;
      padding: 4px 8px;
      cursor: pointer;
    }
    
    .location-nav span.active {
      font-weight: bold;
      color: #ff4d4d;
    }
    
    .location-nav span:not(:last-child)::after {
      content: ">";
      margin: 0 4px;
      color: #bbb;
    }

    .new-badge, .viewed-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: #ff4d4d;
      color: white;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      animation: fadeInOut 0.5s ease-in-out;
    }

    .viewed-badge {
      background-color: #666;
    }

    .favorite-btn {
      position: absolute;
      top: 10px;
      right: 50px;
      z-index: 2;
      color: white;
      font-size: 24px;
      cursor: pointer;
      text-shadow: 0 0 3px rgba(0,0,0,0.5);
      transition: transform 0.2s ease;
    }

    .favorite-btn:hover {
      transform: scale(1.1);
    }

    .favorite-btn.active {
      color: #ffd700;
    }

    /* æ·»åŠ æ”¶è—åŠ¨ç”» */
    @keyframes favorite {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }

    .favorite-animation {
      animation: favorite 0.3s ease;
    }

    .location-group-title {
      font-weight: bold;
      padding: 8px 12px;
      background-color: #f5f5f5;
      margin-top: 10px;
    }

    .location-checkbox {
      margin-right: 8px;
    }

    .selected-item {
      background-color: #e0e0e0;
      padding: 2px 8px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .selected-item .remove-item {
      cursor: pointer;
      color: #666;
      font-size: 12px;
    }

    .selected-item .remove-item:hover {
      color: #ff4d4d;
    }

    .line-group, .station-group {
      margin-bottom: 15px;
    }

    .line-group-title, .station-group-title {
      font-weight: bold;
      padding: 8px 12px;
      background-color: #f5f5f5;
    }

    .multi-select {
      position: relative;
      cursor: pointer;
    }

    .multi-select .selected-items {
      min-height: 22px;
    }

    .multi-select .options-menu {
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .multi-select .option {
      padding: 8px 12px;
      cursor: pointer;
    }

    .multi-select .option:hover {
      background-color: #f5f5f5;
    }

    .multi-select .selected-tag {
      background-color: #e0e0e0;
      padding: 2px 8px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
      margin: 2px;
    }

    .multi-select .remove-tag {
      cursor: pointer;
      color: #666;
      font-size: 12px;
    }

    .multi-select .remove-tag:hover {
      color: #ff4d4d;
    }

    .target-button {
      display: flex;
      align-items: center;
      gap: 8px;
      background-color: #fff;
      border: 2px solid #e0e0e0;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .target-button:hover {
      border-color: #ff4d4d;
      color: #ff4d4d;
    }

    .target-icon {
      font-size: 20px;
    }

    .filter-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      border-radius: 8px;
      overflow: hidden;
    }

    .modal-header {
      padding: 20px;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-body {
      padding: 20px;
      overflow-y: auto;
      max-height: calc(90vh - 140px);
    }

    .modal-footer {
      padding: 20px;
      border-top: 1px solid #e0e0e0;
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    .filter-section {
      margin-bottom: 24px;
    }

    .filter-section h4 {
      margin-bottom: 12px;
      font-weight: bold;
    }

    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .checkbox-group label {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .scrollable {
      max-height: 200px;
      overflow-y: auto;
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
    }

    .line-category {
      margin-bottom: 16px;
    }

    .line-category h5 {
      margin-bottom: 8px;
      font-weight: bold;
    }

    .close-button {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #666;
    }

    .reset-button {
      padding: 8px 16px;
      border: 1px solid #e0e0e0;
      background-color: white;
      border-radius: 4px;
      cursor: pointer;
    }

    .apply-button {
      padding: 8px 24px;
      background-color: #ff4d4d;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .price-range {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .price-range select {
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      width: 150px;
    }

    .update-button {
      display: flex;
      align-items: center;
      gap: 8px;
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .update-button:hover {
      background-color: #45a049;
    }

    .update-button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }

    .update-icon {
      font-size: 20px;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container container">
      <div class="logo" data-ja="æ—¥æœ¬ã®ç‰©ä»¶æ¤œç´¢" data-zh="æ—¥æœ¬æˆ¿æºæœç´¢">æ—¥æœ¬ã®ç‰©ä»¶æ¤œç´¢</div>
      <nav>
        <ul>
          <li><a href="#" data-ja="ãƒ›ãƒ¼ãƒ " data-zh="é¦–é¡µ">ãƒ›ãƒ¼ãƒ </a></li>
          <li><a href="#" data-ja="ãŠæ°—ã«å…¥ã‚Š" data-zh="æ”¶è—">ãŠæ°—ã«å…¥ã‚Š</a></li>
          <li><a href="#" data-ja="ã«ã¤ã„ã¦" data-zh="å…³äº">ã«ã¤ã„ã¦</a></li>
          <li><button class="language-toggle" data-current="ja">ä¸­æ–‡</button></li>
        </ul>
      </nav>
    </div>
  </header>
  
  <!-- åœ¨bodyæ ‡ç­¾å†…ï¼Œmainæ ‡ç­¾å‰æ·»åŠ æç¤ºæ¶ˆæ¯å®¹å™¨ -->
  <div id="updateMessage" style="display: none; position: fixed; top: 20px; right: 20px; background-color: rgba(0, 0, 0, 0.8); color: white; padding: 10px 20px; border-radius: 4px; z-index: 1000;" data-ja="ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯æœ€æ–°ã§ã™" data-zh="ç›®å‰å·²æ˜¯æœ€æ–°æ•°æ®">
    ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯æœ€æ–°ã§ã™
  </div>
  
  <main class="container">
    <div class="view-toggle">
      <button class="active" data-ja="ãƒªã‚¹ãƒˆè¡¨ç¤º" data-zh="åˆ—è¡¨è§†å›¾">ãƒªã‚¹ãƒˆè¡¨ç¤º</button>
      <button data-ja="åœ°å›³è¡¨ç¤º" data-zh="åœ°å›¾è§†å›¾">åœ°å›³è¡¨ç¤º</button>
    </div>
    
    <div class="filters" style="display: flex; justify-content: space-between; align-items: center;">
      <button id="targetButton" class="target-button" data-ja="ç›®æ¨™ã‚’è¨­å®š" data-zh="è®¾ç½®ç›®æ ‡">
        <span class="target-icon">ğŸ¯</span>
        <span class="target-text" data-ja="ç›®æ¨™ã‚’è¨­å®š" data-zh="è®¾ç½®ç›®æ ‡">ç›®æ¨™ã‚’è¨­å®š</span>
      </button>
      
      <button id="updateButton" class="update-button" data-ja="ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°" data-zh="æ›´æ–°æ•°æ®">
        <span class="update-icon">ğŸ”„</span>
        <span class="update-text" data-ja="ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°" data-zh="æ›´æ–°æ•°æ®">ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°</span>
      </button>
    </div>

    <!-- æ·»åŠ ç­›é€‰å¼¹çª— -->
    <div id="filterModal" class="filter-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 data-ja="ç›®æ¨™æ¡ä»¶ã‚’è¨­å®š" data-zh="è®¾ç½®ç›®æ ‡æ¡ä»¶">ç›®æ¨™æ¡ä»¶ã‚’è¨­å®š</h3>
          <button class="close-button">&times;</button>
        </div>
        
        <div class="modal-body">
          <!-- åŒºåŸŸé€‰æ‹© -->
          <div class="filter-section">
            <h4 data-ja="ã‚¨ãƒªã‚¢" data-zh="åŒºåŸŸ">ã‚¨ãƒªã‚¢</h4>
            <div class="filter-group">
              <div class="filter-row">
                <label data-ja="éƒ½çœŒ" data-zh="éƒ½å¿">éƒ½çœŒ</label>
                <div class="checkbox-group">
                  <label><input type="checkbox" value="æ±äº¬éƒ½">æ±äº¬éƒ½</label>
                  <label><input type="checkbox" value="ç¥å¥ˆå·çœŒ">ç¥å¥ˆå·çœŒ</label>
                  <label><input type="checkbox" value="åŸ¼ç‰çœŒ">åŸ¼ç‰çœŒ</label>
                  <label><input type="checkbox" value="åƒè‘‰çœŒ">åƒè‘‰çœŒ</label>
                </div>
              </div>
              <div class="filter-row">
                <label data-ja="è·¯ç·š" data-zh="çº¿è·¯">è·¯ç·š</label>
                <div class="checkbox-group scrollable">
                  <!-- JRçº¿è·¯ -->
                  <div class="line-category">
                    <h5>JRç·š</h5>
                    <label><input type="checkbox" value="å±±æ‰‹ç·š">å±±æ‰‹ç·š</label>
                    <label><input type="checkbox" value="ä¸­å¤®ç·š">ä¸­å¤®ç·š</label>
                    <label><input type="checkbox" value="ç·æ­¦ç·š">ç·æ­¦ç·š</label>
                  </div>
                  <!-- åœ°é“çº¿è·¯ -->
                  <div class="line-category">
                    <h5>æ±äº¬ãƒ¡ãƒˆãƒ­</h5>
                    <label><input type="checkbox" value="éŠ€åº§ç·š">éŠ€åº§ç·š</label>
                    <label><input type="checkbox" value="ä¸¸ãƒå†…ç·š">ä¸¸ãƒå†…ç·š</label>
                    <label><input type="checkbox" value="æ—¥æ¯”è°·ç·š">æ—¥æ¯”è°·ç·š</label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ä»·æ ¼èŒƒå›´ -->
          <div class="filter-section">
            <h4 data-ja="ä¾¡æ ¼" data-zh="ä»·æ ¼">ä¾¡æ ¼</h4>
            <div class="price-range">
              <select id="priceMin">
                <option value="">ä¸‹é™ãªã—</option>
                <option value="1000">1,000ä¸‡å††</option>
                <!-- ... å…¶ä»–é€‰é¡¹ ... -->
              </select>
              <span>ï½</span>
              <select id="priceMax">
                <option value="">ä¸Šé™ãªã—</option>
                <option value="3000">3,000ä¸‡å††</option>
                <!-- ... å…¶ä»–é€‰é¡¹ ... -->
              </select>
            </div>
          </div>

          <!-- é¢ç§¯èŒƒå›´ -->
          <div class="filter-section">
            <h4 data-ja="é¢ç©" data-zh="é¢ç§¯">é¢ç©</h4>
            <div class="checkbox-group">
              <label><input type="checkbox" value="40-60">40ã¡ï½60ã¡</label>
              <label><input type="checkbox" value="60-80">60ã¡ï½80ã¡</label>
              <label><input type="checkbox" value="80-100">80ã¡ï½100ã¡</label>
              <label><input type="checkbox" value="100">100ã¡ä»¥ä¸Š</label>
            </div>
          </div>

          <!-- æˆ¿å‹ -->
          <div class="filter-section">
            <h4 data-ja="é–“å–ã‚Š" data-zh="æˆ¿å‹">é–“å–ã‚Š</h4>
            <div class="checkbox-group">
              <label><input type="checkbox" value="1K">1R/1K</label>
              <label><input type="checkbox" value="1LDK">1DK/1LDK</label>
              <label><input type="checkbox" value="2K">2K/2DK</label>
              <label><input type="checkbox" value="2LDK">2LDK</label>
              <label><input type="checkbox" value="3LDK">3LDKä»¥ä¸Š</label>
            </div>
          </div>

          <!-- æœå‘ -->
          <div class="filter-section">
            <h4 data-ja="å‘ã" data-zh="æœå‘">å‘ã</h4>
            <div class="checkbox-group">
              <label><input type="checkbox" value="south">å—å‘ã</label>
              <label><input type="checkbox" value="east">æ±å‘ã</label>
              <label><input type="checkbox" value="west">è¥¿å‘ã</label>
              <label><input type="checkbox" value="north">åŒ—å‘ã</label>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="reset-button" data-ja="æ¡ä»¶ã‚’ãƒªã‚»ãƒƒãƒˆ" data-zh="é‡ç½®æ¡ä»¶">æ¡ä»¶ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
          <button class="apply-button" data-ja="ã“ã®æ¡ä»¶ã§æ¤œç´¢" data-zh="åº”ç”¨ç­›é€‰">ã“ã®æ¡ä»¶ã§æ¤œç´¢</button>
        </div>
      </div>
    </div>
    
    <div class="list-view">
      <div class="property-card">
        <div class="property-image">
          <div class="status-badge"></div>
          <div class="favorite-btn" data-ja="ãŠæ°—ã«å…¥ã‚Šè¿½åŠ " data-zh="æ·»åŠ æ”¶è—">â˜…</div>
          <img src="https://picsum.photos/id/101/600/400" alt="ç‰©ä»¶ç”»åƒ">
          <div style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" data-ja="3ã¤ã®æƒ…å ±æº" data-zh="3ä¸ªæ¥æº">
            3ã¤ã®æƒ…å ±æº
          </div>
        </div>
        <div class="property-content">
          <div class="property-price">125.5ä¸‡å††</div>
          <div style="font-size: 0.9rem; color: #bbbbbb; margin-bottom: 10px;">æ±äº¬éƒ½æ–°å®¿åŒº1-2-3</div>
          <div style="display: flex; gap: 15px; margin-bottom: 10px;">
            <div style="font-size: 0.9rem;">35ã¡</div>
            <div style="font-size: 0.9rem;">1LDK</div>
            <div style="font-size: 0.9rem;" data-ja="ç¯‰2018å¹´" data-zh="å»ºäº2018å¹´">ç¯‰2018å¹´</div>
          </div>
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; display: flex; flex-wrap: wrap; gap: 8px;">
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              SUUMO
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              at home
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              HOMES
            </a>
          </div>
        </div>
      </div>
      
      <div class="property-card">
        <div class="property-image">
          <div class="status-badge"></div>
          <div class="favorite-btn" data-ja="ãŠæ°—ã«å…¥ã‚Šè¿½åŠ " data-zh="æ·»åŠ æ”¶è—">â˜…</div>
          <img src="https://picsum.photos/id/102/600/400" alt="ç‰©ä»¶ç”»åƒ">
          <div style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" data-ja="2ã¤ã®æƒ…å ±æº" data-zh="2ä¸ªæ¥æº">
            2ã¤ã®æƒ…å ±æº
          </div>
        </div>
        <div class="property-content">
          <div class="property-price">78.0ä¸‡å††</div>
          <div style="font-size: 0.9rem; color: #bbbbbb; margin-bottom: 10px;">æ±äº¬éƒ½æ¸‹è°·åŒº4-5-6</div>
          <div style="display: flex; gap: 15px; margin-bottom: 10px;">
            <div style="font-size: 0.9rem;">25ã¡</div>
            <div style="font-size: 0.9rem;">1K</div>
            <div style="font-size: 0.9rem;" data-ja="ç¯‰2015å¹´" data-zh="å»ºäº2015å¹´">ç¯‰2015å¹´</div>
          </div>
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; display: flex; flex-wrap: wrap; gap: 8px;">
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              SUUMO
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              LIFULL HOME'S
            </a>
          </div>
        </div>
      </div>
      
      <div class="property-card">
        <div class="property-image">
          <div class="status-badge"></div>
          <div class="favorite-btn" data-ja="ãŠæ°—ã«å…¥ã‚Šè¿½åŠ " data-zh="æ·»åŠ æ”¶è—">â˜…</div>
          <img src="https://picsum.photos/id/103/600/400" alt="ç‰©ä»¶ç”»åƒ">
          <div style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" data-ja="4ã¤ã®æƒ…å ±æº" data-zh="4ä¸ªæ¥æº">
            4ã¤ã®æƒ…å ±æº
          </div>
        </div>
        <div class="property-content">
          <div class="property-price">156.8ä¸‡å††</div>
          <div style="font-size: 0.9rem; color: #bbbbbb; margin-bottom: 10px;">æ±äº¬éƒ½æ¸¯åŒº7-8-9</div>
          <div style="display: flex; gap: 15px; margin-bottom: 10px;">
            <div style="font-size: 0.9rem;">48ã¡</div>
            <div style="font-size: 0.9rem;">2LDK</div>
            <div style="font-size: 0.9rem;" data-ja="ç¯‰2020å¹´" data-zh="å»ºäº2020å¹´">ç¯‰2020å¹´</div>
          </div>
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; display: flex; flex-wrap: wrap; gap: 8px;">
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              HOMES
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              at home
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              ã‚«ã‚¦ã‚«ãƒ¢
            </a>
            <a href="#" style="font-size: 0.8rem; color: #1a1a1a; text-decoration: none; padding: 2px 6px; border: 1px solid #e0e0e0; border-radius: 4px;">
              Yahoo!ä¸å‹•ç”£
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- åœ¨mainæ ‡ç­¾å†…,list-viewåæ·»åŠ åœ°å›¾å®¹å™¨ -->
    <div id="map-view" style="display: none; height: 800px; margin-bottom: 20px; border-radius: 8px; overflow: hidden;">
      <div id="map" style="width: 100%; height: 100%;"></div>
    </div>
  </main>
  
  <footer style="background-color: #1a1a1a; color: white; padding: 20px 0; margin-top: 40px;">
    <div class="container" style="text-align: center;">
      <p data-ja="Â© 2023 æ—¥æœ¬ã®ç‰©ä»¶æ¤œç´¢ - ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã®æ—¥æœ¬ä¸å‹•ç”£æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³" data-zh="Â© 2023 æ—¥æœ¬æˆ¿æºæœç´¢ - æç®€é£æ ¼çš„æ—¥æœ¬æˆ¿äº§æœç´¢å¼•æ“">Â© 2023 æ—¥æœ¬ã®ç‰©ä»¶æ¤œç´¢ - ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã®æ—¥æœ¬ä¸å‹•ç”£æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³</p>
    </div>
  </footer>
  
  <!-- ä¿®æ”¹JavaScriptéƒ¨åˆ†,åœ¨scriptæ ‡ç­¾å†…æ·»åŠ åœ°å›¾ç›¸å…³åŠŸèƒ½ -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // è¯­è¨€åˆ‡æ¢åŠŸèƒ½
      const languageToggle = document.querySelector('.language-toggle');
      let currentLang = 'ja'; // é»˜è®¤è¯­è¨€ä¸ºæ—¥è¯­
      
      languageToggle.addEventListener('click', function() {
        // åˆ‡æ¢è¯­è¨€
        currentLang = currentLang === 'ja' ? 'zh' : 'ja';
        this.setAttribute('data-current', currentLang);
        
        // æ›´æ–°æŒ‰é’®æ–‡æœ¬
        this.textContent = currentLang === 'ja' ? 'ä¸­æ–‡' : 'æ—¥æœ¬èª';
        
        // æ›´æ–°æ‰€æœ‰å¸¦æœ‰data-jaå’Œdata-zhå±æ€§çš„å…ƒç´ 
        const elements = document.querySelectorAll('[data-ja][data-zh]');
        elements.forEach(el => {
          el.textContent = el.getAttribute(`data-${currentLang}`);
        });
        
        // æ›´æ–°æ‰€æœ‰è¾“å…¥æ¡†çš„placeholder
        const inputs = document.querySelectorAll('input[data-ja-placeholder][data-zh-placeholder]');
        inputs.forEach(input => {
          input.placeholder = input.getAttribute(`data-${currentLang}-placeholder`);
        });
        
        // æ›´æ–°æ‰€æœ‰é€‰é¡¹çš„æ–‡æœ¬
        const options = document.querySelectorAll('option[data-ja][data-zh]');
        options.forEach(option => {
          option.textContent = option.getAttribute(`data-${currentLang}`);
        });

        // æ›´æ–°æç¤ºæ¶ˆæ¯çš„æ–‡æœ¬
        const updateMessage = document.getElementById('updateMessage');
        if (updateMessage.style.display === 'block') {
          updateMessage.textContent = currentLang === 'ja' ? 'ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯æœ€æ–°ã§ã™' : 'ç›®å‰å·²æ˜¯æœ€æ–°æ•°æ®';
        }

        // æ›´æ–°å·²çœ‹æ ‡ç­¾çš„æ–‡æœ¬
        document.querySelectorAll('.viewed-badge').forEach(badge => {
          badge.textContent = currentLang === 'ja' ? 'é–²è¦§æ¸ˆ' : 'å·²çœ‹';
        });
      });
      
      // åœ°åŒºé€‰æ‹©åŠŸèƒ½
      const locationInput = document.getElementById('location');
      const locationMenu = document.getElementById('locationMenu');
      
      // ç‚¹å‡»è¾“å…¥æ¡†æ—¶æ˜¾ç¤ºåœ°åŒºé€‰æ‹©èœå•
      locationInput.addEventListener('click', function(e) {
        e.stopPropagation();
        locationMenu.classList.toggle('active');
      });
      
      // ç‚¹å‡»é¡µé¢å…¶ä»–éƒ¨åˆ†å…³é—­åœ°åŒºé€‰æ‹©èœå•
      document.addEventListener('click', function(e) {
        if (!locationMenu.contains(e.target) && e.target !== locationInput) {
          locationMenu.classList.remove('active');
        }
      });
      
      // å¯¼èˆªèœå•åˆ‡æ¢
      const prefectureNav = document.querySelector('.location-nav-prefecture');
      const lineNav = document.querySelector('.location-nav-line');
      const stationNav = document.querySelector('.location-nav-station');
      
      const prefectureList = document.querySelector('.prefecture-list');
      const lineList = document.querySelector('.line-list');
      const stationList = document.querySelector('.station-list');
      
      prefectureNav.addEventListener('click', function() {
        prefectureNav.classList.add('active');
        lineNav.classList.remove('active');
        stationNav.classList.remove('active');
        
        prefectureList.style.display = 'block';
        lineList.style.display = 'none';
        stationList.style.display = 'none';
      });
      
      lineNav.addEventListener('click', function() {
        prefectureNav.classList.remove('active');
        lineNav.classList.add('active');
        stationNav.classList.remove('active');
        
        prefectureList.style.display = 'none';
        lineList.style.display = 'block';
        stationList.style.display = 'none';
      });
      
      stationNav.addEventListener('click', function() {
        prefectureNav.classList.remove('active');
        lineNav.classList.remove('active');
        stationNav.classList.add('active');
        
        prefectureList.style.display = 'none';
        lineList.style.display = 'none';
        stationList.style.display = 'block';
      });
      
      // æ·»åŠ å¤šé€‰åŠŸèƒ½
      const selectedLocations = new Set();

      function updateSelectedItems() {
        const selectedItemsContainer = document.querySelector('.selected-items');
        selectedItemsContainer.innerHTML = '';
        
        selectedLocations.forEach(location => {
          const item = document.createElement('div');
          item.className = 'selected-item';
          item.innerHTML = `
            ${location}
            <span class="remove-item" data-value="${location}">Ã—</span>
          `;
          selectedItemsContainer.appendChild(item);
        });
        
        // æ›´æ–°è¾“å…¥æ¡†æ˜¾ç¤º
        const locationInput = document.getElementById('location');
        if (selectedLocations.size === 0) {
          locationInput.setAttribute('data-placeholder', currentLang === 'ja' ? 'éƒ½çœŒã€è·¯ç·šã¾ãŸã¯é§…ã‚’é¸æŠ' : 'é€‰æ‹©éƒ½å¿ã€çº¿è·¯æˆ–è½¦ç«™');
        }
      }

      // å¤„ç†é€‰æ‹©æ¡†ç‚¹å‡»äº‹ä»¶
      document.querySelectorAll('.location-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const value = this.closest('[data-value]').getAttribute('data-value');
          if (this.checked) {
            selectedLocations.add(value);
          } else {
            selectedLocations.delete(value);
          }
          updateSelectedItems();
        });
      });

      // å¤„ç†åˆ é™¤é€‰ä¸­é¡¹
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-item')) {
          const value = e.target.getAttribute('data-value');
          selectedLocations.delete(value);
          // æ›´æ–°å¯¹åº”çš„å¤é€‰æ¡†çŠ¶æ€
          document.querySelectorAll('.location-checkbox').forEach(checkbox => {
            if (checkbox.closest('[data-value]').getAttribute('data-value') === value) {
              checkbox.checked = false;
            }
          });
          updateSelectedItems();
        }
      });
      
      // ä¿®æ”¹æ˜¾ç¤ºçº¿è·¯çš„å‡½æ•°
      function showLinesForPrefecture(prefecture) {
        const allLines = document.querySelectorAll('.line-item');
        allLines.forEach(line => line.style.display = 'none');
        
        // æ ¹æ®é€‰æ‹©çš„éƒ½å¿æ˜¾ç¤ºç›¸åº”çš„çº¿è·¯
        switch(prefecture) {
          case 'æ±äº¬éƒ½':
            document.querySelectorAll('.line-item').forEach(line => line.style.display = 'block');
            break;
          case 'ç¥å¥ˆå·çœŒ':
            // æ˜¾ç¤ºç¥å¥ˆå·å¿çš„çº¿è·¯
            document.querySelectorAll('.line-item[data-area="kanagawa"]').forEach(line => line.style.display = 'block');
            break;
          case 'åŸ¼ç‰çœŒ':
            // æ˜¾ç¤ºåŸ¼ç‰å¿çš„çº¿è·¯
            document.querySelectorAll('.line-item[data-area="saitama"]').forEach(line => line.style.display = 'block');
            break;
          case 'åƒè‘‰çœŒ':
            // æ˜¾ç¤ºåƒå¶å¿çš„çº¿è·¯
            document.querySelectorAll('.line-item[data-area="chiba"]').forEach(line => line.style.display = 'block');
            break;
        }
      }
      
      // è§†å›¾åˆ‡æ¢åŠŸèƒ½
      const viewButtons = document.querySelectorAll('.view-toggle button');
      const listView = document.querySelector('.list-view');
      const mapView = document.getElementById('map-view');
      
      viewButtons.forEach(button => {
        button.addEventListener('click', function() {
          viewButtons.forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          
          if(this.textContent.includes('åœ°å›³') || this.textContent.includes('åœ°å›¾')) {
            listView.style.display = 'none';
            mapView.style.display = 'block';
            // åˆå§‹åŒ–åœ°å›¾
            if (!map) {
              initMap();
            }
            // è§¦å‘resizeäº‹ä»¶ä»¥ç¡®ä¿åœ°å›¾æ­£ç¡®æ˜¾ç¤º
            google.maps.event.trigger(map, 'resize');
          } else {
            listView.style.display = 'grid';
            mapView.style.display = 'none';
          }
        });
      });
      // ç­›é€‰å™¨é‡ç½®åŠŸèƒ½
      const resetButtonFilter = document.querySelector('button[type="button"]');
      if(resetButtonFilter) {
        resetButtonFilter.addEventListener('click', function() {
          document.querySelectorAll('input, select').forEach(input => {
            input.value = '';
          });
        });
      }
      
      // ç­›é€‰å™¨æäº¤åŠŸèƒ½
      const filterForm = document.querySelector('.filters form');
      if(filterForm) {
        filterForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // è·å–å¤šé€‰å€¼
          const getSelectedValues = (selectId) => {
            const checkboxes = document.querySelectorAll(`#${selectId} input[type="checkbox"]:checked`);
            return Array.from(checkboxes).map(cb => cb.value);
          };
          
          const selectedRooms = getSelectedValues('rooms-select');
          const selectedOrientations = getSelectedValues('orientation-select');
          
          // å…¶ä»–ç­›é€‰æ¡ä»¶...
          const location = document.getElementById('location').value;
          const priceMin = document.getElementById('priceMin').value;
          const priceMax = document.getElementById('priceMax').value;
          const areaMin = document.getElementById('areaMin').value;
          const areaMax = document.getElementById('areaMax').value;
          
          // æ˜¾ç¤ºç­›é€‰æ¡ä»¶
          const alertMessage = currentLang === 'ja' 
            ? `æ¤œç´¢æ¡ä»¶:\nåœ°åŒº: ${Array.from(selectedLocations).join(', ') || 'æŒ‡å®šãªã—'}\nä¾¡æ ¼: ${priceMin || '0'} - ${priceMax || 'ä¸é™'}\né¢ç©: ${areaMin || '0'} - ${areaMax || 'ä¸é™'}\né–“å–ã‚Š: ${selectedRooms.join(', ') || 'æŒ‡å®šãªã—'}\nå‘ã: ${selectedOrientations.join(', ') || 'æŒ‡å®šãªã—'}`
            : `ç­›é€‰æ¡ä»¶:\nåœ°åŒº: ${Array.from(selectedLocations).join(', ') || 'ä¸é™'}\nä»·æ ¼: ${priceMin || '0'} - ${priceMax || 'ä¸é™'}\né¢ç§¯: ${areaMin || '0'} - ${areaMax || 'ä¸é™'}\næˆ¿å‹: ${selectedRooms.join(', ') || 'ä¸é™'}\næœå‘: ${selectedOrientations.join(', ') || 'ä¸é™'}`;
          
          alert(alertMessage);
        });
      }

      // æ·»åŠ æµ‹è¯•æ•°æ®æ›´æ–°åŠŸèƒ½
      function getTestData() {
        // æ¨¡æ‹Ÿä»ä¸åŒæ¥æºè·å–çš„æµ‹è¯•æ•°æ®
        const testData = {
          SUUMO: [
            {
              id: "suumo_" + Date.now(),
              sources: ["SUUMO"],
              price: Math.floor(Math.random() * 20000) + 5000,
              location: {
                prefecture: "æ±äº¬éƒ½",
                city: "æ–°å®¿åŒº",
                address: "è¥¿æ–°å®¿" + Math.floor(Math.random() * 10) + "-" + Math.floor(Math.random() * 10),
                station: {
                  name: "æ–°å®¿é§…",
                  line: "JRå±±æ‰‹ç·š",
                  walkingTime: Math.floor(Math.random() * 15) + 1
                },
                coordinates: {
                  lat: 35.6894 + (Math.random() - 0.5) * 0.01,
                  lng: 139.6917 + (Math.random() - 0.5) * 0.01
                }
              },
              specs: {
                size: Math.floor(Math.random() * 60) + 20,
                layout: ["1K", "1LDK", "2DK", "2LDK", "3LDK"][Math.floor(Math.random() * 5)],
                floor: Math.floor(Math.random() * 30) + 1,
                totalFloors: 30,
                direction: ["å—", "æ±", "è¥¿", "åŒ—", "å—æ±", "å—è¥¿"][Math.floor(Math.random() * 6)],
                buildingAge: 2024 - Math.floor(Math.random() * 20)
              },
              features: [
                "ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯",
                "å®…é…ãƒœãƒƒã‚¯ã‚¹",
                "é˜²çŠ¯ã‚«ãƒ¡ãƒ©",
                "24æ™‚é–“ã‚´ãƒŸå‡ºã—å¯"
              ],
              images: [
                {
                  url: `https://picsum.photos/id/${Math.floor(Math.random() * 100)}/600/400`,
                  type: "å¤–è¦³"
                }
              ],
              updatedAt: new Date().toISOString()
            }
          ]
        };

        return testData;
      }

      // ä¿®æ”¹æ›´æ–°æŒ‰é’®åŠŸèƒ½
      document.getElementById('updateButton').addEventListener('click', async function() {
        try {
          // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
          this.disabled = true;
          const originalText = this.querySelector('.update-text').textContent;
          this.querySelector('.update-text').textContent = currentLang === 'ja' ? 'æ›´æ–°ä¸­...' : 'æ›´æ–°ä¸­...';
          
          // æ¨¡æ‹Ÿæ•°æ®è·å–å»¶è¿Ÿ
          await new Promise(resolve => setTimeout(resolve, 1500));
          
          // è·å–æµ‹è¯•æ•°æ®
          const newData = getTestData();
          
          // éšæœºå†³å®šæ˜¯å¦æœ‰æ›´æ–°
          const hasUpdates = Math.random() > 0.3;
          
          if (hasUpdates) {
            // æ·»åŠ æ–°æ•°æ®åˆ°ç°æœ‰åˆ—è¡¨
            const listView = document.querySelector('.list-view');
            newData.SUUMO.forEach(property => {
              const card = createPropertyCard(property);
              listView.insertBefore(card, listView.firstChild);
            });
            
            // å¦‚æœåœ°å›¾è§†å›¾å·²åˆå§‹åŒ–ï¼Œæ›´æ–°åœ°å›¾æ ‡è®°
            if (map) {
              updateMapMarkers([...newData.SUUMO, ...RealEstateData.properties]);
            }
            
            // æ˜¾ç¤ºæ›´æ–°æˆåŠŸæç¤º
            const message = currentLang === 'ja' 
              ? `æ›´æ–°å®Œäº†:\næ–°è¦: ${newData.SUUMO.length}ä»¶\n\næ›´æ–°ã•ã‚ŒãŸæƒ…å ±æº:\n- SUUMO: ${newData.SUUMO.length}ä»¶`
              : `æ›´æ–°å®Œæˆ:\næ–°å¢: ${newData.SUUMO.length}æ¡\n\nå·²æ›´æ–°æ¥æº:\n- SUUMO: ${newData.SUUMO.length}æ¡`;
            
            alert(message);
          } else {
            // æ˜¾ç¤ºæ— æ›´æ–°æç¤º
            const updateMessage = document.getElementById('updateMessage');
            updateMessage.style.display = 'block';
            updateMessage.textContent = currentLang === 'ja' ? 'ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯æœ€æ–°ã§ã™' : 'ç›®å‰å·²æ˜¯æœ€æ–°æ•°æ®';
            
            setTimeout(() => {
              updateMessage.style.display = 'none';
            }, 1500);
          }
        } catch (error) {
          console.error('æ›´æ–°å¤±è´¥:', error);
          alert(currentLang === 'ja' ? 'ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' : 'æ•°æ®æ›´æ–°å¤±è´¥');
        } finally {
          // æ¢å¤æŒ‰é’®çŠ¶æ€
          this.disabled = false;
          this.querySelector('.update-text').textContent = currentLang === 'ja' ? 'ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°' : 'æ›´æ–°æ•°æ®';
        }
      });

      // æ·»åŠ åœ°å›¾ç›¸å…³åŠŸèƒ½
      let map;
      let markers = [];
      const properties = [
        {
          position: { lat: 35.6894, lng: 139.6917 }, // æ–°å®¿
          price: '125.5ä¸‡å††',
          address: 'æ±äº¬éƒ½æ–°å®¿åŒº1-2-3',
          area: '35ã¡',
          layout: '1LDK',
          built: '2018',
          image: 'https://picsum.photos/id/101/600/400'
        },
        {
          position: { lat: 35.6580, lng: 139.7016 }, // æ¸‹è°·
          price: '78.0ä¸‡å††',
          address: 'æ±äº¬éƒ½æ¸‹è°·åŒº4-5-6',
          area: '25ã¡',
          layout: '1K',
          built: '2015',
          image: 'https://picsum.photos/id/102/600/400'
        },
        {
          position: { lat: 35.6585, lng: 139.7454 }, // æ¸¯åŒº
          price: '156.8ä¸‡å††',
          address: 'æ±äº¬éƒ½æ¸¯åŒº7-8-9',
          area: '48ã¡',
          layout: '2LDK',
          built: '2020',
          image: 'https://picsum.photos/id/103/600/400'
        }
      ];

      // åˆå§‹åŒ–åœ°å›¾
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: { lat: 35.6894, lng: 139.6917 }, // é»˜è®¤ä¸­å¿ƒç‚¹è®¾åœ¨æ–°å®¿
          zoom: 13,
          styles: [
            {
              featureType: 'poi',
              elementType: 'labels',
              stylers: [{ visibility: 'off' }]
            }
          ]
        });

        // åˆ›å»ºä¿¡æ¯çª—å£
        const infoWindow = new google.maps.InfoWindow();

        // ä¸ºæ¯ä¸ªæˆ¿æºæ·»åŠ æ ‡è®°
        properties.forEach(property => {
          const marker = new google.maps.Marker({
            position: property.position,
            map: map,
            animation: google.maps.Animation.DROP
          });

          // åˆ›å»ºä¿¡æ¯çª—å£å†…å®¹
          const content = `
            <div style="width: 250px;">
              <img src="${property.image}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 4px;">
              <div style="padding: 10px;">
                <div style="font-size: 1.2rem; font-weight: bold; color: #ff4d4d;">${property.price}</div>
                <div style="font-size: 0.9rem; color: #666; margin: 5px 0;">${property.address}</div>
                <div style="display: flex; gap: 10px; font-size: 0.9rem; color: #333;">
                  <span>${property.area}</span>
                  <span>${property.layout}</span>
                  <span>ç¯‰${property.built}å¹´</span>
                </div>
              </div>
            </div>
          `;

          // æ·»åŠ ç‚¹å‡»äº‹ä»¶
          marker.addListener('click', () => {
            infoWindow.setContent(content);
            infoWindow.open(map, marker);
          });

          markers.push(marker);
        });
      }

      // åˆå§‹åŒ–å¤šé€‰åŠŸèƒ½
      function initMultiSelect(selectId, options) {
        const container = document.getElementById(selectId);
        const selectedItems = container.querySelector('.selected-items');
        const optionsMenu = container.querySelector('.options-menu');
        const checkboxes = optionsMenu.querySelectorAll('input[type="checkbox"]');
        
        // ç‚¹å‡»å®¹å™¨æ˜¾ç¤º/éšè—é€‰é¡¹èœå•
        container.addEventListener('click', (e) => {
          e.stopPropagation();
          optionsMenu.style.display = optionsMenu.style.display === 'none' ? 'block' : 'none';
        });
        
        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
        document.addEventListener('click', () => {
          optionsMenu.style.display = 'none';
        });
        
        // å¤„ç†é€‰é¡¹é€‰æ‹©
        checkboxes.forEach(checkbox => {
          checkbox.addEventListener('change', () => {
            updateSelectedItems();
          });
        });
        
        // æ›´æ–°å·²é€‰é¡¹æ˜¾ç¤º
        function updateSelectedItems() {
          selectedItems.innerHTML = '';
          checkboxes.forEach(checkbox => {
            if (checkbox.checked) {
              const label = checkbox.nextElementSibling.textContent;
              const tag = document.createElement('div');
              tag.className = 'selected-tag';
              tag.innerHTML = `
                ${label}
                <span class="remove-tag" data-value="${checkbox.value}">Ã—</span>
              `;
              selectedItems.appendChild(tag);
            }
          });
        }
        
        // å¤„ç†åˆ é™¤æ ‡ç­¾
        selectedItems.addEventListener('click', (e) => {
          if (e.target.classList.contains('remove-tag')) {
            const value = e.target.dataset.value;
            const checkbox = optionsMenu.querySelector(`input[value="${value}"]`);
            checkbox.checked = false;
            updateSelectedItems();
          }
        });
      }

      // åœ¨æ–‡æ¡£åŠ è½½å®Œæˆååˆå§‹åŒ–å¤šé€‰åŠŸèƒ½
      document.addEventListener('DOMContentLoaded', () => {
        initMultiSelect('rooms-select');
        initMultiSelect('orientation-select');
      });

      // æ·»åŠ æŸ¥çœ‹å’Œæ”¶è—åŠŸèƒ½
      let viewedProperties = JSON.parse(localStorage.getItem('viewedProperties')) || [];
      let favoriteProperties = JSON.parse(localStorage.getItem('favoriteProperties')) || [];
      
      // åˆå§‹åŒ–æ‰€æœ‰æˆ¿æºå¡ç‰‡
      document.querySelectorAll('.property-card').forEach((card, index) => {
        const propertyId = `property-${index}`; // ä¸ºæ¯ä¸ªæˆ¿æºåˆ›å»ºå”¯ä¸€ID
        card.setAttribute('data-property-id', propertyId);
        
        // åˆ›å»ºçŠ¶æ€æ ‡ç­¾å®¹å™¨
        const statusBadge = card.querySelector('.status-badge');
        
        // åˆ›å»ºæ”¶è—æŒ‰é’®
        const favoriteBtn = card.querySelector('.favorite-btn');
        
        // åˆå§‹åŒ–çŠ¶æ€
        if (viewedProperties.includes(propertyId)) {
          updateViewedStatus(statusBadge, true);
        }
        if (favoriteProperties.includes(propertyId)) {
          favoriteBtn.classList.add('active');
        }
        
        // æ·»åŠ ç‚¹å‡»æŸ¥çœ‹äº‹ä»¶
        card.addEventListener('click', function(e) {
          // å¦‚æœç‚¹å‡»çš„æ˜¯æ”¶è—æŒ‰é’®ï¼Œä¸è§¦å‘æŸ¥çœ‹äº‹ä»¶
          if (e.target.classList.contains('favorite-btn')) {
            return;
          }
          
          if (!viewedProperties.includes(propertyId)) {
            viewedProperties.push(propertyId);
            localStorage.setItem('viewedProperties', JSON.stringify(viewedProperties));
            updateViewedStatus(statusBadge, true);
          }
        });
        
        // æ·»åŠ æ”¶è—äº‹ä»¶
        favoriteBtn.addEventListener('click', function(e) {
          e.stopPropagation(); // é˜»æ­¢å†’æ³¡ï¼Œé¿å…è§¦å‘å¡ç‰‡çš„ç‚¹å‡»äº‹ä»¶
          
          this.classList.toggle('active');
          this.classList.add('favorite-animation');
          
          setTimeout(() => {
            this.classList.remove('favorite-animation');
          }, 300);
          
          if (this.classList.contains('active')) {
            if (!favoriteProperties.includes(propertyId)) {
              favoriteProperties.push(propertyId);
              localStorage.setItem('favoriteProperties', JSON.stringify(favoriteProperties));
              showToast(currentLang === 'ja' ? 'ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸ' : 'å·²æ·»åŠ åˆ°æ”¶è—');
            }
          } else {
            favoriteProperties = favoriteProperties.filter(id => id !== propertyId);
            localStorage.setItem('favoriteProperties', JSON.stringify(favoriteProperties));
            showToast(currentLang === 'ja' ? 'ãŠæ°—ã«å…¥ã‚Šã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ' : 'å·²ä»æ”¶è—ä¸­ç§»é™¤');
          }
        });
      });
      
      // æ›´æ–°æŸ¥çœ‹çŠ¶æ€çš„å‡½æ•°
      function updateViewedStatus(statusBadge, isViewed) {
        const existingBadge = statusBadge.querySelector('.new-badge, .viewed-badge');
        if (existingBadge) {
          existingBadge.remove();
        }
        
        if (isViewed) {
          const viewedBadge = document.createElement('div');
          viewedBadge.className = 'viewed-badge';
          viewedBadge.textContent = currentLang === 'ja' ? 'é–²è¦§æ¸ˆ' : 'å·²çœ‹';
          statusBadge.appendChild(viewedBadge);
        }
      }
      
      // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯çš„å‡½æ•°
      function showToast(message) {
        const toast = document.createElement('div');
        toast.style.cssText = `
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          background-color: rgba(0, 0, 0, 0.8);
          color: white;
          padding: 10px 20px;
          border-radius: 4px;
          z-index: 1000;
        `;
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
          toast.remove();
        }, 2000);
      }

      const targetButton = document.getElementById('targetButton');
      const filterModal = document.getElementById('filterModal');
      const closeButton = filterModal.querySelector('.close-button');
      const resetButton = filterModal.querySelector('.reset-button');
      const applyButton = filterModal.querySelector('.apply-button');

      // æ‰“å¼€å¼¹çª—
      targetButton.addEventListener('click', () => {
        filterModal.style.display = 'block';
        document.body.style.overflow = 'hidden';
      });

      // å…³é—­å¼¹çª—
      function closeModal() {
        filterModal.style.display = 'none';
        document.body.style.overflow = '';
      }

      closeButton.addEventListener('click', closeModal);
      filterModal.addEventListener('click', (e) => {
        if (e.target === filterModal) {
          closeModal();
        }
      });

      // é‡ç½®æŒ‰é’®
      resetButton.addEventListener('click', () => {
        filterModal.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
          checkbox.checked = false;
        });
        filterModal.querySelectorAll('select').forEach(select => {
          select.value = '';
        });
      });

      // åº”ç”¨æŒ‰é’®
      applyButton.addEventListener('click', () => {
        // æ”¶é›†æ‰€æœ‰é€‰ä¸­çš„å€¼
        const selectedValues = {
          area: [],
          lines: [],
          price: {
            min: document.getElementById('priceMin').value,
            max: document.getElementById('priceMax').value
          },
          size: [],
          rooms: [],
          orientation: []
        };

        // æ”¶é›†é€‰ä¸­çš„å€¼
        filterModal.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
          // æ ¹æ®ä¸åŒéƒ¨åˆ†æ”¶é›†å€¼
          // ...
        });

        // å…³é—­å¼¹çª—
        closeModal();

        // æ›´æ–°ç­›é€‰ç»“æœ
        // ...
      });

      // å®šä¹‰æˆ¿æºæ•°æ®ç»“æ„
      const RealEstateData = {
        properties: [
          {
            id: "suumo_123456",
            sources: ["SUUMO"], // æ•°æ®æ¥æº
            price: 12550, // å•ä½ï¼šä¸‡æ—¥å…ƒ
            location: {
              prefecture: "æ±äº¬éƒ½",
              city: "æ–°å®¿åŒº",
              address: "è¥¿æ–°å®¿1-2-3",
              station: {
                name: "æ–°å®¿é§…",
                line: "JRå±±æ‰‹ç·š",
                walkingTime: 5 // å¾’æ­¥åˆ†é’Ÿ
              },
              coordinates: {
                lat: 35.6894,
                lng: 139.6917
              }
            },
            specs: {
              size: 35.8, // å¹³æ–¹ç±³
              layout: "1LDK",
              floor: 15,
              totalFloors: 30,
              direction: "å—æ±", // æœå‘
              buildingAge: 2018 // å»ºç­‘å¹´ä»½
            },
            building: {
              type: "ãƒãƒ³ã‚·ãƒ§ãƒ³", // å…¬å¯“ç±»å‹
              structure: "é‰„ç­‹ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆ", // å»ºç­‘ç»“æ„
              totalUnits: 200 // æ€»æˆ·æ•°
            },
            features: [
              "ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯",
              "å®…é…ãƒœãƒƒã‚¯ã‚¹",
              "é˜²çŠ¯ã‚«ãƒ¡ãƒ©",
              "24æ™‚é–“ã‚´ãƒŸå‡ºã—å¯"
            ],
            images: [
              {
                url: "https://picsum.photos/id/101/600/400",
                type: "å¤–è¦³" // å›¾ç‰‡ç±»å‹ï¼šå¤–è§‚/å®¤å†…ç­‰
              }
            ],
            updatedAt: "2024-03-16T10:00:00Z"
          }
          // ... æ›´å¤šæˆ¿æºæ•°æ®
        ]
      };

      // æ·»åŠ æ•°æ®æ¸²æŸ“å‡½æ•°
      function renderProperties(properties) {
        const listView = document.querySelector('.list-view');
        listView.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹

        properties.forEach(property => {
          const card = createPropertyCard(property);
          listView.appendChild(card);
        });

        // å¦‚æœåœ°å›¾è§†å›¾å·²åˆå§‹åŒ–ï¼Œæ›´æ–°åœ°å›¾æ ‡è®°
        if (map) {
          updateMapMarkers(properties);
        }
      }

      // åˆ›å»ºæˆ¿æºå¡ç‰‡
      function createPropertyCard(property) {
        const card = document.createElement('div');
        card.className = 'property-card';
        card.setAttribute('data-property-id', property.id);

        // æ ¼å¼åŒ–ä»·æ ¼æ˜¾ç¤º
        const formattedPrice = new Intl.NumberFormat('ja-JP').format(property.price);
        
        // è®¡ç®—æ•°æ®æ¥æºæ•°é‡
        const sourceCount = property.sources.length;

        card.innerHTML = `
          <div class="property-image">
            <div class="status-badge"></div>
            <div class="favorite-btn" data-ja="ãŠæ°—ã«å…¥ã‚Šè¿½åŠ " data-zh="æ·»åŠ æ”¶è—">â˜…</div>
            <img src="${property.images[0].url}" alt="${property.location.address}">
            <div class="source-count" style="position: absolute; top: 10px; right: 10px; background-color: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;" 
                 data-ja="${sourceCount}ã¤ã®æƒ…å ±æº" data-zh="${sourceCount}ä¸ªæ¥æº">
              ${sourceCount}ã¤ã®æƒ…å ±æº
            </div>
          </div>
          <div class="property-content">
            <div class="property-price">${formattedPrice}ä¸‡å††</div>
            <div class="property-location">
              ${property.location.prefecture}${property.location.city}
              <div class="station-info">
                ${property.location.station.line} ${property.location.station.name} å¾’æ­©${property.location.station.walkingTime}åˆ†
              </div>
            </div>
            <div class="property-specs">
              <span>${property.specs.size}ã¡</span>
              <span>${property.specs.layout}</span>
              <span>ç¯‰${new Date().getFullYear() - property.specs.buildingAge}å¹´</span>
              <span>${property.specs.direction}</span>
            </div>
            <div class="property-features">
              ${property.features.slice(0, 3).map(feature => 
                `<span class="feature-tag">${feature}</span>`
              ).join('')}
            </div>
            <div class="property-sources">
              ${property.sources.map(source => 
                `<a href="#" class="source-link">${source}</a>`
              ).join('')}
            </div>
          </div>
        `;

        // æ·»åŠ äº¤äº’åŠŸèƒ½
        initializeCardInteractions(card, property);

        return card;
      }

      // åˆå§‹åŒ–å¡ç‰‡äº¤äº’åŠŸèƒ½
      function initializeCardInteractions(card, property) {
        const favoriteBtn = card.querySelector('.favorite-btn');
        const statusBadge = card.querySelector('.status-badge');
        const propertyId = property.id;

        // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°ä¸Šæ¶çš„æˆ¿æºï¼ˆ24å°æ—¶å†…ï¼‰
        const isNew = (new Date() - new Date(property.updatedAt)) < 24 * 60 * 60 * 1000;
        if (isNew) {
          const newBadge = document.createElement('div');
          newBadge.className = 'new-badge';
          newBadge.textContent = 'NEW';
          statusBadge.appendChild(newBadge);
        }

        // æ·»åŠ æ”¶è—åŠŸèƒ½
        favoriteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          
          favoriteBtn.classList.toggle('active');
          favoriteBtn.classList.add('favorite-animation');
          
          setTimeout(() => {
            favoriteBtn.classList.remove('favorite-animation');
          }, 300);
          
          if (favoriteBtn.classList.contains('active')) {
            if (!favoriteProperties.includes(propertyId)) {
              favoriteProperties.push(propertyId);
              localStorage.setItem('favoriteProperties', JSON.stringify(favoriteProperties));
              showToast(currentLang === 'ja' ? 'ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸ' : 'å·²æ·»åŠ åˆ°æ”¶è—');
            }
          } else {
            favoriteProperties = favoriteProperties.filter(id => id !== propertyId);
            localStorage.setItem('favoriteProperties', JSON.stringify(favoriteProperties));
            showToast(currentLang === 'ja' ? 'ãŠæ°—ã«å…¥ã‚Šã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ' : 'å·²ä»æ”¶è—ä¸­ç§»é™¤');
          }
        });

        // æ·»åŠ æŸ¥çœ‹åŠŸèƒ½
        card.addEventListener('click', () => {
          if (!viewedProperties.includes(propertyId)) {
            viewedProperties.push(propertyId);
            localStorage.setItem('viewedProperties', JSON.stringify(viewedProperties));
            updateViewedStatus(statusBadge, true);
          }
          
          // è¿™é‡Œå¯ä»¥æ·»åŠ æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯çš„é€»è¾‘
          showPropertyDetail(property);
        });
      }

      // æ·»åŠ æ˜¾ç¤ºæˆ¿æºè¯¦ç»†ä¿¡æ¯çš„å‡½æ•°
      function showPropertyDetail(property) {
        // åˆ›å»ºè¯¦ç»†ä¿¡æ¯å¼¹çª—
        const detailModal = document.createElement('div');
        detailModal.className = 'property-detail-modal';
        detailModal.innerHTML = `
          <div class="modal-content">
            <div class="modal-header">
              <h3>${property.location.address}</h3>
              <button class="close-button">&times;</button>
            </div>
            <div class="modal-body">
              <!-- æ·»åŠ è¯¦ç»†ä¿¡æ¯å†…å®¹ -->
              <div class="property-images">
                <img src="${property.images[0].url}" alt="ç‰©ä»¶ç”»åƒ">
              </div>
              <div class="property-info">
                <div class="price">${new Intl.NumberFormat('ja-JP').format(property.price)}ä¸‡å††</div>
                <div class="location">
                  ${property.location.station.line} ${property.location.station.name} å¾’æ­©${property.location.station.walkingTime}åˆ†
                </div>
                <div class="specs">
                  <div>${property.specs.size}ã¡</div>
                  <div>${property.specs.layout}</div>
                  <div>${property.specs.direction}</div>
                  <div>ç¯‰${new Date().getFullYear() - property.specs.buildingAge}å¹´</div>
                </div>
                <div class="features">
                  ${property.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                </div>
              </div>
            </div>
          </div>
        `;

        document.body.appendChild(detailModal);

        // æ·»åŠ å…³é—­åŠŸèƒ½
        const closeButton = detailModal.querySelector('.close-button');
        closeButton.addEventListener('click', () => {
          detailModal.remove();
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        detailModal.addEventListener('click', (e) => {
          if (e.target === detailModal) {
            detailModal.remove();
          }
        });
      }

      // æ›´æ–°åœ°å›¾æ ‡è®°
      function updateMapMarkers(properties) {
        // æ¸…é™¤ç°æœ‰æ ‡è®°
        markers.forEach(marker => marker.setMap(null));
        markers = [];

        // æ·»åŠ æ–°æ ‡è®°
        properties.forEach(property => {
          const marker = new google.maps.Marker({
            position: property.location.coordinates,
            map: map,
            animation: google.maps.Animation.DROP
          });

          // åˆ›å»ºä¿¡æ¯çª—å£å†…å®¹
          const infoWindow = new google.maps.InfoWindow({
            content: createInfoWindowContent(property)
          });

          marker.addListener('click', () => {
            infoWindow.open(map, marker);
          });

          markers.push(marker);
        });
      }

      // åˆ›å»ºä¿¡æ¯çª—å£å†…å®¹
      function createInfoWindowContent(property) {
        return `
          <div class="map-info-window">
            <img src="${property.images[0].url}" alt="${property.location.address}" 
                 style="width: 200px; height: 150px; object-fit: cover; border-radius: 4px;">
            <div style="padding: 10px;">
              <div style="font-size: 1.2rem; font-weight: bold; color: #ff4d4d;">
                ${new Intl.NumberFormat('ja-JP').format(property.price)}ä¸‡å††
              </div>
              <div style="font-size: 0.9rem; margin: 5px 0;">
                ${property.location.station.line} ${property.location.station.name} å¾’æ­©${property.location.station.walkingTime}åˆ†
              </div>
              <div style="font-size: 0.9rem;">
                ${property.specs.size}ã¡ / ${property.specs.layout}
              </div>
            </div>
          </div>
        `;
      }

      // åˆå§‹åŒ–æ•°æ®
      document.addEventListener('DOMContentLoaded', () => {
        // æ¸²æŸ“åˆå§‹æ•°æ®
        renderProperties(RealEstateData.properties);
      });
    });
  </script>
</body>
</html> 